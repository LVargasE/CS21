# -*- coding: utf-8 -*-
"""     A10--Trivia Game!
        --> two player trivia game
        --> OOP approach to building the game with classes and objects
"""
import csv
import random

# the Question class acts as a placeholder for the parts of the question
# needed to construct questions and check answers
class Question:
    # __init__ uses the Data class method getData through composition
    def __init__(self, question, a1, a2, a3, a4, answer, ansNum):
        self.getData = Data('csv')
        self.question = question
        self.a1 = a1
        self.a2 = a2
        self.a3 = a3
        self.a4 = a4
        self.answer = answer
        self.ansNum = ansNum

    # the method performs better as a class method since it instantiates the
    # Question class with sample questions for the game
    @classmethod
    def getQuestion(cls, triviaDict):
        # using random to get 10 random numbers between a specific range for
        # trivia questions
        randomGenerator = random.sample(range(1, 817), 1)

        # for an individual random number in the sample range
        # --> iterate and use number as index for the trivia questions
        for i in randomGenerator:
            question = triviaDict[i][0]
            a1 = triviaDict[i][1]
            a2= triviaDict[i][2]
            a3 = triviaDict[i][3]
            a4 = triviaDict[i][4]
            answer = triviaDict[i][5]
            ansNum = triviaDict[i][6]

        # this creates an instance to return (from question class)
        aQuestion = Question(question, a1, a2, a3, a4, answer, ansNum)
        return aQuestion

    # this is a part of using composition rather than inheritance to get the
    # attributes from the getData method
    def __getattr__(self, attr):
        return getattr(self.getData, attr)

    # this method sets up the question (also checks answer)
    @classmethod
    def setupAsk(cls, q):
        print('\n', q.question, '\n\t1: ', q.a1, ' \
                 \n\t2: ', q.a2, '\n\t3: ', q.a3, ' \
                 \n\t4: ', q.a4, '\n')

        # make sure the user's input works
        while True:
            try:
                choice = int(input("\nWhat's your answer? \n--> "))
            except ValueError:
                print('\nSorry, the answer only accepts numbers; please \
                       enter a number 1-4')
                choice = int(input("\nWhat's your answer? \n--> "))
            finally:
                if choice in range(1, 5):
                    break

        # if the question is correct, return true; if not, return false
        if choice == q.ansNum:
            print('\nCorrect! \n', q.answer)
            return True
        elif choice != q.ansNum:
            print('\nIncorrect!  \n', q.answer)
            return False

# the Data class handles openning the file and preparing it to be used by
# the Question and Game class
class Data:
    def __init__(self, filetype):
        self.filetype = filetype

    # opens the CSV to read and prepare it to be used in computaiton later
    @classmethod
    def getData(cls):
        # make sure there isn't an IO error
        try:
            # open the csv file + use an index accumulator for dictionary
            with open('trivia.csv') as csvFile:
                readCSV = csv.reader(csvFile, delimiter=',')
                index = 0

                # questions, answer choices, and answers dictionary
                rowDict = {}
                questionData = {}
                # reading the trivia questions
                for row in readCSV:
                    rowDict[index] = row
                    question = rowDict[index][0]
                    a1 = rowDict[index][1]
                    a2 = rowDict[index][2]
                    a3 = rowDict[index][3]
                    a4 = rowDict[index][4]
                    answer = rowDict[index][5]

                    # figure out which answer is correct and assign a variable
                    if answer == a1:
                        ansNum = 1
                    elif answer == a2:
                        ansNum = 2
                    elif answer == a3:
                        ansNum = 3
                    elif answer == a4:
                        ansNum = 4
                    else:
                        print("Error!  No correct answer")

                    # place questions into new dictionary in the right order
                    questionData[index] = [question, a1, a2, a3, a4, \
                                            answer, ansNum]
                    index += 1

                return questionData

        except IOError:
            print("The file could not be found.")

# the Game class is where the bulk of the game's structure is found
class Game:
    def __init__(self, playerID, gamePoints):
        self.playerID = playerID
        self.gamePoints = gamePoints

    # method to create instances for questions and find out if a quesiton
    # was answered correctly or not
    def round(self, qClass, data):
        gamePoints = 0 # reset to 0 for new round

        # instances
        q1 = qClass.getQuestion(data)
        q2 = qClass.getQuestion(data)
        q3 = qClass.getQuestion(data)
        q4 = qClass.getQuestion(data)
        q5 = qClass.getQuestion(data)

        # return value is true or false; this computes points
        if qClass.setupAsk(q1) == True:
            gamePoints += 1
        if qClass.setupAsk(q2) == True:
            gamePoints += 1
        if qClass.setupAsk(q3) == True:
            gamePoints += 1
        if qClass.setupAsk(q4) == True:
            gamePoints += 1
        if qClass.setupAsk(q5) == True:
            gamePoints += 1

        # let the user know what happenned this round
        print('you won {} points this game!'.format(gamePoints))

        return gamePoints

def main():
    # local variables
    flag = False
    gameNum = 1

    # instance of Data class
    data = Data('csv')
    questionsData = data.getData()

    # instance of Question class with filler data
    questions = Question('question', 'a1', 'a2', 'a3', 'a4', \
                         'answer', 'ansNum')

    # create both players
    playerOne = Game(str(input('PLAYER ONE//\nEnter your name: ')), 0,)
    playerTwo = Game(str(input('PLAYER TWO//\nEnter your name: ')), 0,)

    # while loop to keep the game going if the user chooses
    while flag != True:
        # let the user know which round they're playing
        print('\nROUND ', gameNum, '//\nPlayer One')

        # first player instance; asks five questions
        p1round = playerOne.round(questions, questionsData)

        print("""
        +++++++++++++++++++++++++++++++++++++++++++++++++
        +                   SWITCH PLAYERS!             +
        +++++++++++++++++++++++++++++++++++++++++++++++++
        """)

        # let the user know to switch players
        print('\nROUND ', gameNum, '//\nPlayer Two')

        # second player instance; asks the five quesitons
        p2round = playerTwo.round(questions, questionsData)

        # let the user know which round they are on with accumulator
        gameNum += 1

        # figure out who won and use user's inputed name and their points
        # in print statement
        if p1round < p2round:
            print('Thank you for playing!  {} is the winner with {} total \
                  game points!'.format(playerTwo.playerID, p2round))
        elif p2round < p1round:
            print('Thank you for playing!  {} is the winner with {} total \
                  game points!'.format(playerOne.playerID, p1round))
        elif p2round == p1round:
            print('There was a tie!  Both {} and {} both earned {} total \
                   game points; but you are both still \
                   winners!'.format(playerOne.playerID, playerTwo.playerID, \
                   p1round))

        # find out if user wants to continue + validate user response
        while True:
            try:
                choice = str(input("\nKeep playing? \n--> ")).upper()
            except ValueError:
                print("Sorry, enter either a 'Y' for 'Yes', or 'N' for 'No'.")
            finally:
                if choice == 'N':
                    flag = True
                    break
                if choice == 'Y':
                    break
                else:
                    print("please enter either a 'Y' for 'Yes', or 'N' \
                           for 'No'.")

    # say bye to players and quit the program
    print('\nThank you for playing!  See you next time!\n')

main()

------------ OUTPUT ------------
Python 3.4.2 |Anaconda 2.1.0 (64-bit)| (default, Oct 21 2014, 17:16:37)
[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>>
PLAYER ONE//
Enter your name: Connie
PLAYER TWO//
Enter your name: Robert

ROUND  1 //
Player One

 In which sport would you hear the terms axel loop and spin?
  1:  Bowling
  2:  Sailing
  3:  Alpine skiing
  4:  Figure skating


What's your answer?
--> figure skating

Sorry, the answer only accepts numbers; please
enter a number 1-4

What's your answer?
--> 4

Correct!
 Figure skating

 The Prince of Wales is the heir apparent to the British throne. The Prince of
 Asturias is the heir to what country's throne?
  1:  Sweden
  2:  Netherlands
  3:  Spain
  4:  Denmark


What's your answer?
--> 4

Incorrect!
 Spain

 Which country created the rumba?
  1:  Cuba
  2:  Japan
  3:  Spain
  4:  Lithuania


What's your answer?
--> 1

Correct!
 Cuba

 Which broadcaster said the famous words "Down Goes Frasier! Down Goes Frasier!
 Down Goes Frasier!"?
  1:  Dick Irvine
  2:  Dick Young
  3:  Jimmy Cannon
  4:  Howard Cosell


What's your answer?
--> 4

Correct!
 Howard Cosell

 Although actually buried in Cambridge Massachusetts who was the first American
 to get his bust put up at Poets' Corner of Westminster Abbey?
  1:  Carl Sandburg
  2:  TS Eliot
  3:  Henry Wadsworth Longfellow
  4:  Walt Whitman


What's your answer?
--> 4

Incorrect!
 Henry Wadsworth Longfellow
you won 3 points this game!

        +++++++++++++++++++++++++++++++++++++++++++++++++
        +                   SWITCH PLAYERS!             +
        +++++++++++++++++++++++++++++++++++++++++++++++++


ROUND  1 //
Player Two

 What country makes up the western third of the island of Hispaniola?
  1:  Cuba
  2:  Dominican Republic
  3:  Haiti
  4:  Puerto Rico


What's your answer?
--> 2

Incorrect!
 Haiti

 Who invented the telescope?
  1:  Edwin Powell Hubble
  2:  Galileo
  3:  Nicolaus Copernicus
  4:  Hans Lippershey


What's your answer?
--> 2

Incorrect!
 Hans Lippershey

 Confining ourselves to city limits France's second-largest city is what major
 port in its lowest southeastern corner in the Provence-Alpes-Cote d'Azur region?
  1:  Marseilles
  2:  Nice
  3:  Lyon
  4:  Toulouse


What's your answer?
--> 1

Correct!
 Marseilles

 In the Kingsley Amis book Lucky Jim is Jim Dixon. What does he do for a living?
  1:  Represent Wonking-Wapping in Parliament
  2:  Teach at a minor UK university
  3:  Swindle little old ladies
  4:  Fiddle the books for a corporation


What's your answer?
--> 4

Incorrect!
 Teach at a minor UK university

 In the 1986 book "Engines of Creation" Eric Drexler described what then
 futuristic technology?
  1:  Fiber optics
  2:  Cloning
  3:  Nanotechnology
  4:  Robotics


What's your answer?
--> 3

Correct!
 Nanotechnology
you won 2 points this game!
Thank you for playing!  Connie is the winner with 3 total
game points!

Keep playing?
--> yes
please enter either a 'Y' for 'Yes', or 'N'
for 'No'.

Keep playing?
--> y

ROUND  2 //
Player One

 Who painted the Old Guitarist?
  1:  Monet
  2:  Renoir
  3:  Picasso
  4:  Van Gogh


What's your answer?
--> 3

Correct!
 Picasso

 How many colors are there in a rainbow?
  1:  15
  2:  9
  3:  7
  4:  12


What's your answer?
--> 4

Incorrect!
 7

 In 1988 whose toothbrush sold for an astonishing $21 000?
  1:  John F. Kennedy
  2:  Pablo Picasso
  3:  Liberace
  4:  Napoleon


What's your answer?
--> 1

Incorrect!
 Napoleon

 What 1775 battle did poet Ralph Waldo Emerson call the "shot heard around the
 world" in a poem he wrote to dedicate an obelisk at the site?
  1:  Saratoga
  2:  Bunker Hill
  3:  Concord
  4:  Yorkton


What's your answer?
--> 3

Correct!
 Concord

 Rupert's Land was named for Prince Rupert the Bohemian-born cousin of
 Charles II. In 1870 what country bought it?
  1:  Canada
  2:  Brazil
  3:  United States
  4:  Australia


What's your answer?
--> 4

Incorrect!
 Canada
you won 2 points this game!

        +++++++++++++++++++++++++++++++++++++++++++++++++
        +                   SWITCH PLAYERS!             +
        +++++++++++++++++++++++++++++++++++++++++++++++++


ROUND  2 //
Player Two

 What was Jacqueline Kennedy Onassis' maiden name?
  1:  Goldblum
  2:  Rothschild
  3:  Windsor
  4:  Bouvier


What's your answer?
--> 2

Incorrect!
 Bouvier

 Who discovered X-Rays?
  1:  Martin Luther
  2:  Sir Isaac Newton
  3:  Arthur Schopenhauer
  4:  Wilhelm Roentgen


What's your answer?
--> 4

Correct!
 Wilhelm Roentgen

 A staple of science fiction what theoretical particle can theoretically go
 faster than light?
  1:  Baryon
  2:  Quark
  3:  Tachyon
  4:  Photon


What's your answer?
--> 3

Correct!
 Tachyon

 When this racquet sport was added to the Olympics in 1992 Indonesia won the
 first gold medals which in fact were its first ever gold medals. What was the
 sport?
  1:  Table tennis
  2:  Tennis
  3:  Squash
  4:  Badminton


What's your answer?
--> 1

Incorrect!
 Badminton

 In the 1990s Norman Foster added a glass dome to what capitol building
 originally completed in 1894?
  1:  Reichstag
  2:  Sejm
  3:  Diet
  4:  Knesset


What's your answer?
--> 1

Correct!
 Reichstag
you won 3 points this game!
Thank you for playing!  Robert is the winner with 3 total
game points!

Keep playing?
--> n

Thank you for playing!  See you next time!
>>>
